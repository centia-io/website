---
title: Statements
description: Execute parameterized SELECT, INSERT, UPDATE and DELETE via the SQL API.
sidebar_position: 50
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Statements

Data can be retrieved and altered using the `sql` API.

Only `select`, `insert`, `update` and `delete` statements can be executed. Any other types of SQL (DDL, transaction control, etc.) will be rejected by the API.

Send an HTTP POST to the SQL endpoint with a JSON body:
- `q`: the SQL text. Use named parameters like `:name` with explicit casts (e.g., `:id::int`).
- `params`: an object with values for each named parameter.
- `type_hints` (optional): help the server parse complex types.
- `type_formats` (optional): control formatting for date/time outputs.
- `id` (optional): a unique identifier for the request. The server will return the same identifier in the response.
Useful for tracking requests in a websocket context. If omitted:
    - In REST context: The server will generate a random UUID in the response.
    - In Websocket context: The server will not send any message.

See also: [Types](./types) for data type formatting/conversion and [Rules](./rules) for row-level access control and query limiting.

## Select

<Tabs>
  <TabItem value="http" label="HTTP" default>

    ```http title="Select rows with parameters"
    POST http://localhost:8080/api/v4/sql HTTP/1.1
    Content-Type: application/json
    Accept: application/json
    Authorization: Bearer abc123

    {
      "q": "select id, name from my_schema.my_table where id = :id::int",
      "params": { "id": 1 },
      "id": "1"
    }
    ```

    ```json title="Response"
    {
      "schema": {
        "id": { "type": "int4", "array": false },
        "name": { "type": "varchar", "array": false }
      },
      "data": [
        { "id": 1, "name": "Martin" }
      ]
    }
    ```

  </TabItem>
  <TabItem value="cli" label="CLI">

    ```bash title="Select rows"
    echo "select id, name from my_schema.my_table where id = 1" | centia sql
    ```

  </TabItem>
</Tabs>

## Insert

<Tabs>
  <TabItem value="http" label="HTTP" default>

    ```http title="Insert a row and return values"
    POST http://localhost:8080/api/v4/sql HTTP/1.1
    Content-Type: application/json
    Accept: application/json
    Authorization: Bearer abc123

    {
      "q": "insert into my_schema.my_table (id, name) values (:id::int, :name::varchar) returning id, name",
      "params": { "id": 2, "name": "Alice" }
    }
    ```

    ```json title="Response"
    {
      "schema": {
        "id": { "type": "int4", "array": false },
        "name": { "type": "varchar", "array": false }
      },
      "data": [
        { "id": 2, "name": "Alice" }
      ]
    }
    ```

  </TabItem>
  <TabItem value="cli" label="CLI">

    ```bash title="Insert a row"
    echo "insert into my_schema.my_table (id, name) values (2, 'Alice') returning id, name" | centia sql
    ```

  </TabItem>
</Tabs>

## Update

<Tabs>
  <TabItem value="http" label="HTTP" default>

    ```http title="Update a row and return the changed values"
    POST http://localhost:8080/api/v4/sql HTTP/1.1
    Content-Type: application/json
    Accept: application/json
    Authorization: Bearer abc123

    {
      "q": "update my_schema.my_table set name = :name::varchar where id = :id::int returning id, name",
      "params": { "id": 2, "name": "Alice Cooper" }
    }
    ```

    ```json title="Response"
    {
      "schema": {
        "id": { "type": "int4", "array": false },
        "name": { "type": "varchar", "array": false }
      },
      "data": [
        { "id": 2, "name": "Alice Cooper" }
      ]
    }
    ```

  </TabItem>
  <TabItem value="cli" label="CLI">

    ```bash title="Update a row"
    echo "update my_schema.my_table set name = 'Alice Cooper' where id = 2 returning id, name" | centia sql
    ```

  </TabItem>
</Tabs>

## Delete

<Tabs>
  <TabItem value="http" label="HTTP" default>

    ```http title="Delete a row and return the id"
    POST http://localhost:8080/api/v4/sql HTTP/1.1
    Content-Type: application/json
    Accept: application/json
    Authorization: Bearer abc123

    {
      "q": "delete from my_schema.my_table where id = :id::int returning id",
      "params": { "id": 2 }
    }
    ```

    ```json title="Response"
    {
      "schema": {
        "id": { "type": "int4", "array": false }
      },
      "data": [
        { "id": 2 }
      ]
    }
    ```

  </TabItem>
  <TabItem value="cli" label="CLI">

    ```bash title="Delete a row"
    echo "delete from my_schema.my_table where id = 2 returning id" | centia sql
    ```

  </TabItem>
</Tabs>

## Notes

- Always use parameters (e.g., `:id`) and explicit casts (`::type`) to ensure correct typing and protect against SQL injection.
- Result objects include a `schema` section describing each returned column and a `data` array with the actual rows.
- Access may be limited or denied by configured [Rules](./rules). Refer to [Types](./types) for handling complex types and formatting.
